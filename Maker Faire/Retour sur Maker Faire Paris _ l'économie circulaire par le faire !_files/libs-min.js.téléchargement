
Ext.util.base64={base64s:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",encode:function(decStr){if(typeof btoa==='function'){return btoa(unescape(encodeURIComponent(decStr)))}
var base64s=this.base64s;var bits;var dual;var i=0;var encOut="";while(decStr.length>=i+3){bits=(decStr.charCodeAt(i++)&0xff)<<16|(decStr.charCodeAt(i++)&0xff)<<8|decStr.charCodeAt(i++)&0xff;encOut+=base64s.charAt((bits&0x00fc0000)>>18)+base64s.charAt((bits&0x0003f000)>>12)+base64s.charAt((bits&0x00000fc0)>>6)+base64s.charAt((bits&0x0000003f));}
if(decStr.length-i>0&&decStr.length-i<3){dual=Boolean(decStr.length-i-1);bits=((decStr.charCodeAt(i++)&0xff)<<16)|(dual?(decStr.charCodeAt(i)&0xff)<<8:0);encOut+=base64s.charAt((bits&0x00fc0000)>>18)+base64s.charAt((bits&0x0003f000)>>12)+(dual?base64s.charAt((bits&0x00000fc0)>>6):'=')+'=';}
return(encOut);},decode:function(encStr){if(typeof atob==='function'){return atob(encStr);}
var base64s=this.base64s;var bits;var decOut="";var i=0;for(;i<encStr.length;i+=4){bits=(base64s.indexOf(encStr.charAt(i))&0xff)<<18|(base64s.indexOf(encStr.charAt(i+1))&0xff)<<12|(base64s.indexOf(encStr.charAt(i+2))&0xff)<<6|base64s.indexOf(encStr.charAt(i+3))&0xff;decOut+=String.fromCharCode((bits&0xff0000)>>16,(bits&0xff00)>>8,bits&0xff);}
if(encStr.charCodeAt(i-2)==61){return(decOut.substring(0,decOut.length-2));}
else if(encStr.charCodeAt(i-1)==61){return(decOut.substring(0,decOut.length-1));}
else{return(decOut);}}};accentsTidy=function(s){var r=s.toLowerCase();r=r.replace(new RegExp("[àáâãäå]",'g'),"a");r=r.replace(new RegExp("æ",'g'),"ae");r=r.replace(new RegExp("ç",'g'),"c");r=r.replace(new RegExp("[èéêë]",'g'),"e");r=r.replace(new RegExp("[ìíîï]",'g'),"i");r=r.replace(new RegExp("ñ",'g'),"n");r=r.replace(new RegExp("[òóôõö]",'g'),"o");r=r.replace(new RegExp("œ",'g'),"oe");r=r.replace(new RegExp("[ùúûü]",'g'),"u");r=r.replace(new RegExp("[ýÿ]",'g'),"y");return r;};function utf8_encode(string){string=(string+'').replace(/\r\n/g,"\n").replace(/\r/g,"\n");var utftext="";var start,end;var stringl=0;start=end=0;stringl=string.length;for(var n=0;n<stringl;n++){var c1=string.charCodeAt(n);var enc=null;if(c1<128){end++;}else if((c1>127)&&(c1<2048)){enc=String.fromCharCode((c1>>6)|192)+String.fromCharCode((c1&63)|128);}else{enc=String.fromCharCode((c1>>12)|224)+String.fromCharCode(((c1>>6)&63)|128)+String.fromCharCode((c1&63)|128);}
if(enc!=null){if(end>start){utftext+=string.substring(start,end);}
utftext+=enc;start=end=n+1;}}
if(end>start){utftext+=string.substring(start,string.length);}
return utftext;}
function utf8_decode(str_data){var tmp_arr=[],i=0,ac=0,c1=0,c2=0,c3=0;str_data+='';while(i<str_data.length){c1=str_data.charCodeAt(i);if(c1<128){tmp_arr[ac++]=String.fromCharCode(c1);i++;}else if((c1>191)&&(c1<224)){c2=str_data.charCodeAt(i+1);tmp_arr[ac++]=String.fromCharCode(((c1&31)<<6)|(c2&63));i+=2;}else{c2=str_data.charCodeAt(i+1);c3=str_data.charCodeAt(i+2);tmp_arr[ac++]=String.fromCharCode(((c1&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}
return tmp_arr.join('');}
function strtr(str,from,to){var fr='',i=0,lgth=0;if(typeof from==='object'){for(fr in from){str=str.replace(fr,from[fr]);}
return str;}
lgth=to.length;if(from.length<to.length){lgth=from.length;}
for(i=0;i<lgth;i++){str=str.replace(from[i],to[i],'g');}
return str;}
function strtolower(str){return(str+'').toLowerCase();}
function strip_tags(str,allowed_tags){var key='',allowed=false;var matches=[];var allowed_array=[];var allowed_tag='';var i=0;var k='';var html='';var replacer=function(search,replace,str){return str.split(search).join(replace);};if(allowed_tags){allowed_array=allowed_tags.match(/([a-zA-Z]+)/gi);}
str+='';matches=str.match(/(<\/?[\S][^>]*>)/gi);for(key in matches){if(isNaN(key)){continue;}
html=matches[key].toString();allowed=false;for(k in allowed_array){allowed_tag=allowed_array[k];i=-1;if(i!=0){i=html.toLowerCase().indexOf('<'+allowed_tag+'>');}
if(i!=0){i=html.toLowerCase().indexOf('<'+allowed_tag+' ');}
if(i!=0){i=html.toLowerCase().indexOf('</'+allowed_tag);}
if(i==0){allowed=true;break;}}
if(!allowed){str=replacer(html,"",str);}}
return str;}
function base64_decode(data){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var o1,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,dec="",tmp_arr=[];if(!data){return data;}
data+='';do{h2=b64.indexOf(data.charAt(i++));h3=b64.indexOf(data.charAt(i++));h4=b64.indexOf(data.charAt(i++));bits=h1<<18|h2<<12|h3<<6|h4;o1=bits>>16&0xff;o2=bits>>8&0xff;o3=bits&0xff;if(h3==64){tmp_arr[ac++]=String.fromCharCode(o1);}else if(h4==64){tmp_arr[ac++]=String.fromCharCode(o1,o2);}else{tmp_arr[ac++]=String.fromCharCode(o1,o2,o3);}}while(i<data.length);dec=tmp_arr.join('');dec=this.utf8_decode(dec);return dec;}
(function(){var EV=Ext.lib.Event;var MIM;Ext.ux.ManagedIFrame=function(){var args=Array.prototype.slice.call(arguments,0),el=Ext.get(args[0]),config=args[0];if(el&&el.dom&&el.dom.tagName=='IFRAME'){config=args[1]||{};}else{config=args[0]||args[1]||{};el=config.autoCreate?Ext.get(Ext.DomHelper.append(config.autoCreate.parent||Ext.getBody(),Ext.apply({tag:'iframe',frameborder:0,src:(Ext.isIE&&Ext.isSecure)?Ext.SSL_SECURE_URL:'about:blank'},config.autoCreate))):null;if(el&&this.unsupportedText){Ext.DomHelper.append(el.dom.parentNode,{tag:'noframes',html:this.unsupportedText});}}
if(!el||el.dom.tagName!='IFRAME'){return el;}
el.dom.name||(el.dom.name=el.dom.id);el.dom.ownerEl=el;this.addEvents({"focus":true,"blur":true,"unload":true,"domready":true,"documentloaded":true,"exception":true,"message":true});if(config.listeners){this.listeners=config.listeners;Ext.ux.ManagedIFrame.superclass.constructor.call(this);}
Ext.apply(el,this);el.addClass('x-managed-iframe');if(config.style){el.applyStyles(config.style);}
Ext.apply(el,{disableMessaging:config.disableMessaging===true,loadMask:!!config.loadMask?Ext.apply({msg:'Loading..',msgCls:'x-mask-loading',maskEl:null,hideOnReady:false,disabled:false},config.loadMask):false,_windowContext:null,eventsFollowFrameLinks:typeof config.eventsFollowFrameLinks=='undefined'?true:config.eventsFollowFrameLinks});if(el.loadMask){el.loadMask.maskEl||(el.loadMask.maskEl=el.parent('.x-managed-iframe-mask')||el.parent().addClass('x-managed-iframe-mask'));}
var um=el.updateManager=new Ext.UpdateManager(el,true);um.showLoadIndicator=config.showLoadIndicator||false;Ext.ux.ManagedIFrame.Manager.register(el);if(config.src){el.setSrc(config.src);}else{var content=config.html||config.content||false;if(content){el.reset(null,function(frame){frame.update.apply(el,[].concat(content));});}}
return el;};Ext.extend(Ext.ux.ManagedIFrame,Ext.util.Observable,{src:null,CSS:null,manager:null,disableMessaging:true,resetUrl:(function(){if(Ext.isIE&&Ext.isSecure){return Ext.SSL_SECURE_URL;}else{return'about:blank';}})(),unsupportedText:'Inline frames are NOT enabled\/supported by your browser.',setSrc:function(url,discardUrl,callback,scope){if(url&&typeof url=='object'){callback=url.callback||false;discardUrl=url.discardUrl||false;url=url.url||false;scope=url.scope||null;}
var src=url||this.src||this.resetUrl;this._windowContext=null;this._unHook();this._frameAction=this.frameInit=this._domReady=false;this.showMask();(function(){var s=this._targetURI=typeof src=='function'?src()||'':src;try{this._frameAction=true;this._callBack=typeof callback=='function'?callback.createDelegate(scope):null;this.dom.src=s;this.frameInit=true;this.checkDOM();}catch(ex){this.fireEvent('exception',this,ex);}}).defer(10,this);if(discardUrl!==true){this.src=src;}
return this;},setLocation:function(url,discardUrl,callback,scope){if(url&&typeof url=='object'){callback=url.callback||false;discardUrl=url.discardUrl||false;url=url.url||false;scope=url.scope||null;}
var src=url||this.src||this.resetUrl;this._windowContext=null;this._unHook();this._frameAction=this.frameInit=this._domReady=false;this.showMask();(function(){var s=this._targetURI=typeof src=='function'?src()||'':src;try{this._frameAction=true;this._callBack=typeof callback=='function'?callback.createDelegate(scope):null;this.getWindow().location.replace(s);this.frameInit=true;this.checkDOM();}catch(ex){this.fireEvent('exception',this,ex);}}).defer(10,this);if(discardUrl!==true){this.src=src;}
return this;},reset:function(src,callback,scope){this._unHook();var loadMaskOff=false;if(this.loadMask){loadMaskOff=this.loadMask.disabled;this.loadMask.disabled=false;}
this._callBack=function(frame){if(frame.loadMask){frame.loadMask.disabled=loadMaskOff;};frame._frameAction=false;frame.frameInit=true;this._isReset=false;if(callback){callback.call(scope||window,frame);}};this.hideMask(true);this._frameAction=false;this.frameInit=true
this._isReset=true;var s=src;if(typeof src=='function'){s=src();}
s=this._targetURI=Ext.isEmpty(s,true)?this.resetUrl:s;this.getWindow().location.href=s;return this;},scriptRE:/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,update:function(content,loadScripts,callback,scope){loadScripts=loadScripts||this.getUpdateManager().loadScripts||false;content=Ext.DomHelper.markup(content||'');content=loadScripts===true?content:content.replace(this.scriptRE,"");var doc;if((doc=this.getDocument())&&!!content.length){this._unHook();this._windowContext=this.src=null;this._targetURI=location.href;this.frameInit=true;this.showMask();(function(){this._callBack=typeof callback=='function'?callback.createDelegate(scope):null;doc.open();this._frameAction=true;doc.write(content);doc.close();this.checkDOM();}).defer(10,this);}else{this.hideMask(true);if(callback){callback.call(scope,this);}}
return this;},disableMessaging:true,_XFrameMessaging:function(){var tagStack={'$':[]};var isEmpty=function(v,allowBlank){return v===null||v===undefined||(!allowBlank?v==='':false);};window.sendMessage=function(message,tag,origin){var MIF;if(MIF=arguments.callee.manager){if(message._fromHost){var fn,result;var compTag=message.tag||tag||null;var mstack=!isEmpty(compTag)?tagStack[compTag.toLowerCase()]||[]:tagStack["$"];for(var i=0,l=mstack.length;i<l;i++){if(fn=mstack[i]){result=fn.apply(fn.__scope,arguments)===false?false:result;if(fn.__single){mstack[i]=null;}
if(result===false){break;}}}
return result;}else{message={type:isEmpty(tag)?'message':'message:'
+tag.toLowerCase().replace(/^\s+|\s+$/g,''),data:message,domain:origin||document.domain,uri:document.documentURI,source:window,tag:isEmpty(tag)?null:tag.toLowerCase()};try{return MIF.disableMessaging!==true?MIF.fireEvent.call(MIF,message.type,MIF,message):null;}catch(ex){}
return null;}}};window.onhostmessage=function(fn,scope,single,tag){if(typeof fn=='function'){if(!isEmpty(fn.__index)){throw"onhostmessage: duplicate handler definition"
+(tag?" for tag:"+tag:'');}
var k=isEmpty(tag)?"$":tag.toLowerCase();tagStack[k]||(tagStack[k]=[]);Ext.apply(fn,{__tag:k,__single:single||false,__scope:scope||window,__index:tagStack[k].length});tagStack[k].push(fn);}else{throw"onhostmessage: function required";}};window.unhostmessage=function(fn){if(typeof fn=='function'&&typeof fn.__index!='undefined'){var k=fn.__tag||"$";tagStack[k][fn.__index]=null;}};},getHistory:function(){var h=null;try{h=this.getWindow().history;}catch(eh){}
return h;},get:function(el){return MIM.El.get(this,el);},fly:function(el,named){named=named||'_global';el=this.getDom(el);if(!el){return null;}
if(!MIM._flyweights[named]){MIM._flyweights[named]=new Ext.Element.Flyweight();}
MIM._flyweights[named].dom=el;return MIM._flyweights[named];},getDom:function(el){var d;if(!el||!(d=this.getDocument())){return null;}
return el.dom?el.dom:(typeof el=='string'?d.getElementById(el):el);},select:function(selector,unique){var d;return(d=this.getDocument())?Ext.Element.select(selector,unique,d):null;},query:function(selector){var d;return(d=this.getDocument())?Ext.DomQuery.select(selector,d):null;},getDoc:function(){return this.get(this.getDocument());},removeNode:function(node){MIM.removeNode(this,this.getDom(node));},_unHook:function(){var elcache,h=MIM.getFrameHash(this)||{};if(this._hooked&&h&&(elcache=h.elCache)){for(var id in elcache){var el=elcache[id];if(el.removeAllListeners){el.removeAllListeners();}
delete elcache[id];}
if(h.docEl){h.docEl.removeAllListeners();h.docEl=null;delete h.docEl;}}
this.CSS=this.CSS?this.CSS.destroy():null;this._hooked=this._domReady=this._domFired=false;},_renderHook:function(){this._windowContext=null;this.CSS=this.CSS?this.CSS.destroy():null;this._hooked=false;try{if(this.writeScript('(function(){(window.hostMIF = parent.Ext.get("'
+this.dom.id
+'"))._windowContext='
+(Ext.isIE?'window':'{eval:function(s){return eval(s);}}')
+';})();')){this._frameProxy||(this._frameProxy=MIM.eventProxy.createDelegate(this));var w;if(w=this.getWindow()){EV.doAdd(w,'focus',this._frameProxy);EV.doAdd(w,'blur',this._frameProxy);EV.doAdd(w,'unload',this._frameProxy);}
if(this.disableMessaging!==true){this.loadFunction({name:'XMessage',fn:this._XFrameMessaging},false,true);var sm;if(sm=w.sendMessage){sm.manager=this;}}
this.CSS=new CSSInterface(this.getDocument());}}catch(ex){}
return this.domWritable();},sendMessage:function(message,tag,origin){var win;if(this.disableMessaging!==true&&(win=this.getWindow())){tag||(tag=message.tag||'');tag=tag.toLowerCase();message=Ext.applyIf(message.data?message:{data:message},{type:Ext.isEmpty(tag)?'message':'message:'
+tag,domain:origin||document.domain,uri:document.documentURI,source:window,tag:tag||null,_fromHost:this});return win.sendMessage?win.sendMessage.call(null,message,tag,origin):null;}
return null;},_windowContext:null,getDocument:function(){var win=this.getWindow(),doc=null;try{doc=(Ext.isIE&&win?win.document:null)||this.dom.contentDocument||window.frames[this.id].document||null;}catch(gdEx){return false;}
return doc;},getBody:function(){var d;return(d=this.getDocument())?d.body:null;},getDocumentURI:function(){var URI,d;try{URI=this.src&&(d=this.getDocument())?d.location.href:null;}catch(ex){}
return URI||(typeof this.src=='function'?this.src():this.src);},getWindowURI:function(){var URI,w;try{URI=(w=this.getWindow())?w.location.href:null;}catch(ex){}
return URI||(typeof this.src=='function'?this.src():this.src);},getWindow:function(){var dom=this.dom,win=null;try{win=dom.contentWindow||window.frames[dom.name]||null;}catch(gwEx){}
return win;},print:function(){var win;try{if(win=this.getWindow()){if(Ext.isIE){win.focus();}
win.print();}}catch(ex){throw'print exception: '+(ex.description||ex.message||ex);}},destroy:function(){this.removeAllListeners();if(this.loadMask){this.hideMask(true);Ext.apply(this.loadMask,{masker:null,maskEl:null});}
if(this.dom){Ext.ux.ManagedIFrame.Manager.deRegister(this);this.dom.ownerEl=this._windowContext=null;if(Ext.isIE&&this.dom.src){this.dom.src='javascript:false';}
this._maskEl=null;this.remove();}},domWritable:function(){return!!this._windowContext;},execScript:function(block,useDOM){try{if(this.domWritable()){if(useDOM){this.writeScript(block);}else{return this._windowContext.eval(block);}}else{throw'execScript:non-secure context'}}catch(ex){this.fireEvent('exception',this,ex);return false;}
return true;},writeScript:function(block,attributes){attributes=Ext.apply({},attributes||{},{type:"text/javascript",text:block});try{var head,script,doc=this.getDocument();if(doc&&typeof doc.getElementsByTagName!='undefined'){if(!(head=doc.getElementsByTagName("head")[0])){head=doc.createElement("head");doc.getElementsByTagName("html")[0].appendChild(head);}
if(head&&(script=doc.createElement("script"))){for(var attrib in attributes){if(attributes.hasOwnProperty(attrib)&&attrib in script){script[attrib]=attributes[attrib];}}
return!!head.appendChild(script);}}}catch(ex){this.fireEvent('exception',this,ex);}
return false;},loadFunction:function(fn,useDOM,invokeIt){var name=fn.name||fn;var fn=fn.fn||window[fn];this.execScript(name+'='+fn,useDOM);if(invokeIt){this.execScript(name+'()');}},showMask:function(msg,msgCls,forced){var lmask=this.loadMask;if(lmask&&!lmask.disabled){lmask.masker||(lmask.masker=Ext.get(lmask.maskEl||this.dom.parentNode||this.wrap({tag:'div',style:{position:'static'}})));(function(){this._vis=!!this.masker.mask(msg||this.msg,msgCls||this.msgCls);}).defer(lmask.delay||10,lmask)}},hideMask:function(forced){var tlm=this.loadMask;if(tlm&&!tlm.disabled&&tlm.masker){if(forced||(tlm.hideOnReady&&this._domReady)){tlm.masker.unmask();tlm._vis=false;}}},loadHandler:function(e,target){if(!this.frameInit||(!this._frameAction&&!this.eventsFollowFrameLinks)){return;}
target||(target={});var rstatus=(e&&typeof e.type!=='undefined'?e.type:this.dom.readyState);switch(rstatus){case'domready':if(this._domReady){return;}
this._domReady=true;if(this._frameAction&&this.getDocumentURI()!='about:blank'&&(this._hooked=this._renderHook())){this._domFired=true;this.fireEvent("domready",this);}
case'domfail':this._domReady=true;this.hideMask();break;case'load':case'complete':if(!this._domReady){this.loadHandler({type:'domready',id:this.id},this.dom);}
this.hideMask(true);if(this._frameAction||this.eventsFollowFrameLinks){this.fireEvent.defer(1,this,["documentloaded",this]);if(this._callBack){this._callBack.defer(1,null,[this]);}}
this._frameAction=this._frameInit=false;if(this.eventsFollowFrameLinks){this._domFired=this._domReady=false;}
break;default:}
this.frameState=rstatus;},checkDOM:function(win){if(Ext.isOpera||Ext.isGecko||!this._frameAction){return;}
var n=0,manager=this,domReady=false,b,l,d,max=300,polling=false,startLocation=(this.getDocument()||{location:{}}).location.href;(function(){d=manager.getDocument()||{location:{}};polling=(d.location.href!==startLocation||d.location.href===manager._targetURI);if(!manager._frameAction||manager._domReady){return;}
domReady=polling&&((b=manager.getBody())&&!!(b.innerHTML||'').length)||false;if(d.location.href&&!domReady&&(++n<max)){setTimeout(arguments.callee,2);return;}
manager.loadHandler({type:domReady?'domready':'domfail'});})();}});var styleCamelRe=/(-[a-z])/gi;var styleCamelFn=function(m,a){return a.charAt(1).toUpperCase();};var CSSInterface=function(hostDocument){var doc;if(hostDocument){doc=hostDocument;return{rules:null,destroy:function(){return doc=null;},createStyleSheet:function(cssText,id){var ss;if(!doc)
return;var head=doc.getElementsByTagName("head")[0];var rules=doc.createElement("style");rules.setAttribute("type","text/css");if(id){rules.setAttribute("id",id);}
if(Ext.isIE){head.appendChild(rules);ss=rules.styleSheet;ss.cssText=cssText;}else{try{rules.appendChild(doc.createTextNode(cssText));}catch(e){rules.cssText=cssText;}
head.appendChild(rules);ss=rules.styleSheet?rules.styleSheet:(rules.sheet||doc.styleSheets[doc.styleSheets.length
-1]);}
this.cacheStyleSheet(ss);return ss;},removeStyleSheet:function(id){if(!doc)
return;var existing=doc.getElementById(id);if(existing){existing.parentNode.removeChild(existing);}},swapStyleSheet:function(id,url){this.removeStyleSheet(id);if(!doc)
return;var ss=doc.createElement("link");ss.setAttribute("rel","stylesheet");ss.setAttribute("type","text/css");ss.setAttribute("id",id);ss.setAttribute("href",url);doc.getElementsByTagName("head")[0].appendChild(ss);},refreshCache:function(){return this.getRules(true);},cacheStyleSheet:function(ss){if(this.rules){this.rules={};}
try{var ssRules=ss.cssRules||ss.rules;for(var j=ssRules.length-1;j>=0;--j){this.rules[ssRules[j].selectorText]=ssRules[j];}}catch(e){}},getRules:function(refreshCache){if(this.rules==null||refreshCache){this.rules={};if(doc){var ds=doc.styleSheets;for(var i=0,len=ds.length;i<len;i++){try{this.cacheStyleSheet(ds[i]);}catch(e){}}}}
return this.rules;},getRule:function(selector,refreshCache){var rs=this.getRules(refreshCache);if(!Ext.isArray(selector)){return rs[selector];}
for(var i=0;i<selector.length;i++){if(rs[selector[i]]){return rs[selector[i]];}}
return null;},updateRule:function(selector,property,value){if(!Ext.isArray(selector)){var rule=this.getRule(selector);if(rule){rule.style[property.replace(styleCamelRe,styleCamelFn)]=value;return true;}}else{for(var i=0;i<selector.length;i++){if(this.updateRule(selector[i],property,value)){return true;}}}
return false;}};}};Ext.ux.ManagedIframePanel=Ext.extend(Ext.Panel,{defaultSrc:null,bodyStyle:{position:'relative'},frameStyle:{overflow:'auto'},frameConfig:null,hideMode:!Ext.isIE?'nosize':'display',shimCls:'x-frame-shim',shimUrl:null,loadMask:false,stateful:false,animCollapse:Ext.isIE&&Ext.enableFx,autoScroll:false,closable:true,ctype:"Ext.ux.ManagedIframePanel",showLoadIndicator:false,unsupportedText:'Inline frames are NOT enabled\/supported by your browser.',initComponent:function(){var f=this.frameConfig?this.frameConfig.autoCreate||this.frameConfig:{};var frCfg={id:f.id||Ext.id()};frCfg.name=f.name||frCfg.id;if(Ext.isIE&&Ext.isSecure){frCfg.src=Ext.SSL_SECURE_URL;}
var frameTag=Ext.apply({tag:'iframe',frameborder:0,cls:'x-managed-iframe',style:this.frameStyle||f.style||{}},frCfg);var unsup=this.unsupportedText?{tag:'noframes',html:this.unsupportedText}:[];this.bodyCfg||(this.bodyCfg={cls:this.baseCls+'-body',children:this.contentEl?[]:[frameTag].concat(unsup)});this.autoScroll=false;this.items=null;if(this.stateful!==false){this.stateEvents||(this.stateEvents=['documentloaded']);}
Ext.ux.ManagedIframePanel.superclass.initComponent.call(this);this.monitorResize||(this.monitorResize=!!this.fitToParent);this.addEvents({documentloaded:true,domready:true,message:true,exception:true,blur:true,focus:true});this.addListener=this.on;},doLayout:function(){if(this.fitToParent&&!this.ownerCt){var pos=this.getPosition(),size=(Ext.get(this.fitToParent)||this.getEl().parent()).getViewSize();this.setSize(size.width-pos[0],size.height-pos[1]);}
Ext.ux.ManagedIframePanel.superclass.doLayout.apply(this,arguments);},beforeDestroy:function(){if(this.rendered){if(this.tools){for(var k in this.tools){Ext.destroy(this.tools[k]);}}
if(this.header&&this.headerAsText){var s;if(s=this.header.child('span'))s.remove(true,true);this.header.update('');}
Ext.each(['iframe','shim','header','topToolbar','bottomToolbar','footer','loadMask','body','bwrap'],function(elName){if(this[elName]){if(typeof this[elName].destroy=='function'){this[elName].destroy();}else{Ext.destroy(this[elName]);}
this[elName]=null;delete this[elName];}},this);}
Ext.ux.ManagedIframePanel.superclass.beforeDestroy.call(this);},onDestroy:function(){Ext.Panel.superclass.onDestroy.call(this);},afterRender:function(container){var html=this.html;delete this.html;Ext.ux.ManagedIframePanel.superclass.afterRender.apply(this,arguments);if(this.iframe=this.body.child('iframe')){this.iframe.ownerCt=this;if(this.loadMask){var mEl;if(mEl=this.loadMask.maskEl){this.loadMask.maskEl=this[mEl]||mEl||this.body;this.loadMask.maskEl.addClass('x-managed-iframe-mask');}
this.loadMask=Ext.apply({disabled:false,hideOnReady:false},this.loadMask);}
this.getUpdater().showLoadIndicator=this.showLoadIndicator||false;var ownerCt=this.ownerCt;while(ownerCt){ownerCt.on('afterlayout',function(container,layout){var MIM=Ext.ux.ManagedIFrame.Manager,st=false;Ext.each(['north','south','east','west'],function(region){var reg;if((reg=layout[region])&&reg.splitEl){st=true;if(!reg.split._splitTrapped){reg.split.on('beforeresize',MIM.showShims,MIM);reg.split._splitTrapped=true;}}},this);if(st&&!this._splitTrapped){this.on('resize',MIM.hideShims,MIM);this._splitTrapped=true;}},this,{single:true});ownerCt=ownerCt.ownerCt;}
this.shim=Ext.get(this.body.child('.'+this.shimCls))||Ext.DomHelper.append(this.body,{tag:'img',src:this.shimUrl||Ext.BLANK_IMAGE_URL,cls:this.shimCls,galleryimg:"no"},true);var El=Ext.Element;var mode=El[this.hideMode.toUpperCase()]||'x-hide-nosize';Ext.each([this[this.collapseEl],this.floating?null:this.getActionEl(),this.iframe],function(el){if(el)
el.setVisibilityMode(mode);},this);if(this.iframe=new Ext.ux.ManagedIFrame(this.iframe,{loadMask:this.loadMask,showLoadIndicator:this.showLoadIndicator,disableMessaging:this.disableMessaging,style:this.frameStyle,src:this.defaultSrc,html:html}))
{this.loadMask=this.iframe.loadMask;this.iframe.ownerCt=this;this.relayEvents(this.iframe,["blur","focus","unload","documentloaded","domready","exception","message"].concat(this._msgTagHandlers||[]));delete this._msgTagHandlers;}}},sendMessage:function(){if(this.iframe){this.iframe.sendMessage.apply(this.iframe,arguments);}},on:function(name){var tagRE=/^message\:/i,n=null;if(typeof name=='object'){for(var na in name){if(!this.filterOptRe.test(na)&&tagRE.test(na)){n||(n=[]);n.push(na.toLowerCase());}}}else if(tagRE.test(name)){n=[name.toLowerCase()];}
if(this.getFrame()&&n){this.relayEvents(this.iframe,n);}else{this._msgTagHandlers||(this._msgTagHandlers=[]);if(n)
this._msgTagHandlers=this._msgTagHandlers.concat(n);}
Ext.ux.ManagedIframePanel.superclass.on.apply(this,arguments);},setSrc:function(url,discardUrl,callback,scope){url=url||this.defaultSrc||false;if(url&&this.rendered&&this.iframe){this.iframe.setSrc.call(this.iframe,url,discardUrl,callback,scope);}
return this;},setLocation:function(url,discardUrl,callback,scope){url=url||this.defaultSrc||false;if(url&&this.rendered&&this.iframe){this.iframe.setLocation.call(this.iframe,url,discardUrl,callback,scope);}
return this;},getState:function(){var URI=this.iframe?this.iframe.getDocumentURI()||null:null;return Ext.apply(Ext.ux.ManagedIframePanel.superclass.getState.call(this)||{},URI?{defaultSrc:typeof URI=='function'?URI():URI}:null);},getUpdater:function(){return this.rendered?(this.iframe||this.body).getUpdater():null;},getFrame:function(){return this.rendered?this.iframe:null},getFrameWindow:function(){return this.rendered&&this.iframe?this.iframe.getWindow():null;},getFrameDocument:function(){return this.rendered&&this.iframe?this.iframe.getDocument():null;},getFrameDoc:function(){return this.rendered&&this.iframe?this.iframe.getDoc():null;},getFrameBody:function(){return this.rendered&&this.iframe?this.iframe.getBody():null;},load:function(loadCfg){var um;if(um=this.getUpdater()){if(loadCfg&&loadCfg.renderer){um.setRenderer(loadCfg.renderer);delete loadCfg.renderer;}
um.update.apply(um,arguments);}
return this;},doAutoLoad:function(){this.load(typeof this.autoLoad=='object'?this.autoLoad:{url:this.autoLoad});}});Ext.ux.ManagedIFrame.Manager=MIM=function(){var frames={};var implementation={readyHandler:function(e){try{var $frame=e.target.ownerEl;if($frame&&$frame._frameAction){$frame.loadHandler.call($frame,{type:'domready'});}}catch(rhEx){return}},shimCls:'x-frame-shim',register:function(frame){frame.manager=this;frames[frame.id]=frames[frame.dom.name]={ref:frame,elCache:{}};frame.dom[Ext.isIE?'onreadystatechange':'onload']=frame.loadHandler.createDelegate(frame);return frame;},deRegister:function(frame){frame._unHook();frame.dom.onload=frame.dom.onreadystatechange=null;delete frames[frame.id];delete frames[frame.dom.name];},hideShims:function(){if(!this.shimApplied)
return;Ext.select('.'+this.shimCls,true).removeClass(this.shimCls
+'-on');this.shimApplied=false;},showShims:function(){if(!this.shimApplied){this.shimApplied=true;Ext.select('.'+this.shimCls,true).addClass(this.shimCls
+'-on');}},getFrameById:function(id){return typeof id=='string'?(frames[id]?frames[id].ref||null:null):null;},getFrameByName:function(name){return this.getFrameById(name);},getFrameHash:function(frame){return frame.id?frames[frame.id]:null;},eventProxy:function(e){if(!e)
return;e=Ext.EventObject.setEvent(e);var be=e.browserEvent||e;if(e.type=='unload'){this._unHook();}
if(!be['eventPhase']||(be['eventPhase']==(be['AT_TARGET']||2))){return this.fireEvent(e.type,e);}},_flyweights:{},destroy:function(){if(document.addEventListener){window.removeEventListener("DOMFrameContentLoaded",this.readyHandler,true);}},removeNode:Ext.isIE?function(frame,n){frame=MIM.getFrameHash(frame);if(frame&&n&&n.tagName!='BODY'){d=frame.scratchDiv||(frame.scratchDiv=frame.getDocument().createElement('div'));d.appendChild(n);d.innerHTML='';}}:function(frame,n){if(n&&n.parentNode&&n.tagName!='BODY'){n.parentNode.removeChild(n);}}};if(document.addEventListener){window.addEventListener("DOMFrameContentLoaded",implementation.readyHandler,true);}
Ext.EventManager.on(window,'beforeunload',implementation.destroy,implementation);return implementation;}();MIM.showDragMask=MIM.showShims;MIM.hideDragMask=MIM.hideShims;MIM.El=function(frame,el,forceNew){var frameObj;frame=(frameObj=MIM.getFrameHash(frame))?frameObj.ref:null;if(!frame){return null;}
var elCache=frameObj.elCache||(frameObj.elCache={});var dom=frame.getDom(el);if(!dom){return null;}
var id=dom.id;if(forceNew!==true&&id&&elCache[id]){return elCache[id];}
this.dom=dom;this.id=id||Ext.id(dom);};MIM.El.get=function(frame,el){var ex,elm,id,doc;if(!frame||!el){return null;}
var frameObj;frame=(frameObj=MIM.getFrameHash(frame))?frameObj.ref:null;if(!frame){return null;}
var elCache=frameObj.elCache||(frameObj.elCache={});if(!(doc=frame.getDocument())){return null;}
if(typeof el=="string"){if(!(elm=frame.getDom(el))){return null;}
if(ex=elCache[el]){ex.dom=elm;}else{ex=elCache[el]=new MIM.El(frame,elm);}
return ex;}else if(el.tagName){if(!(id=el.id)){id=Ext.id(el);}
if(ex=elCache[id]){ex.dom=el;}else{ex=elCache[id]=new MIM.El(frame,el);}
return ex;}else if(el instanceof MIM.El){if(el!=frameObj.docEl){el.dom=frame.getDom(el.id)||el.dom;elCache[el.id]=el;}
return el;}else if(el.isComposite){return el;}else if(Ext.isArray(el)){return frame.select(el);}else if(el==doc){if(!frameObj.docEl){var f=function(){};f.prototype=MIM.El.prototype;frameObj.docEl=new f();frameObj.docEl.dom=doc;}
return frameObj.docEl;}
return null;};Ext.apply(MIM.El.prototype,Ext.Element.prototype);Ext.ns('Ext.ux.panel','Ext.ux.portlet');Ext.reg('iframepanel',Ext.ux.panel.ManagedIframe=Ext.ux.ManagedIframePanel);Ext.ux.ManagedIframePortlet=Ext.extend(Ext.ux.ManagedIframePanel,{anchor:'100%',frame:true,collapseEl:'bwrap',collapsible:true,draggable:true,cls:'x-portlet'});Ext.reg('iframeportlet',Ext.ux.portlet.ManagedIframe=Ext.ux.ManagedIframePortlet);Ext.apply(Ext.Element.prototype,{setVisible:function(visible,animate){if(!animate||!Ext.lib.Anim){if(this.visibilityMode==Ext.Element.DISPLAY){this.setDisplayed(visible);}else if(this.visibilityMode==Ext.Element.VISIBILITY){this.fixDisplay();this.dom.style.visibility=visible?"visible":"hidden";}else{this[visible?'removeClass':'addClass'](String(this.visibilityMode));}}else{var dom=this.dom;var visMode=this.visibilityMode;if(visible){this.setOpacity(.01);this.setVisible(true);}
this.anim({opacity:{to:(visible?1:0)}},this.preanim(arguments,1),null,.35,'easeIn',function(){if(!visible){if(visMode==Ext.Element.DISPLAY){dom.style.display="none";}else if(visMode==Ext.Element.VISIBILITY){dom.style.visibility="hidden";}else{Ext.get(dom).addClass(String(visMode));}
Ext.get(dom).setOpacity(1);}});}
return this;},isVisible:function(deep){var vis=!(this.hasClass(this.visibilityMode)||this.getStyle("visibility")=="hidden"||this.getStyle("display")=="none");if(deep!==true||!vis){return vis;}
var p=this.dom.parentNode;while(p&&p.tagName.toLowerCase()!="body"){if(!Ext.fly(p,'_isVisible').isVisible()){return false;}
p=p.parentNode;}
return true;}});Ext.onReady(function(){var CSS=Ext.util.CSS,rules=[];CSS.getRule('.x-managed-iframe')||(rules.push('.x-managed-iframe {height:100%;width:100%;overflow:auto;position:relative;}'));CSS.getRule('.x-managed-iframe-mask')||(rules.push('.x-managed-iframe-mask{position:relative;zoom:1;}'));if(!CSS.getRule('.x-frame-shim')){rules.push('.x-frame-shim {z-index:8500;position:absolute;top:0px;left:0px;background:transparent!important;overflow:hidden;display:none;}');rules.push('.x-frame-shim-on{width:100%;height:100%;display:block;zoom:1;}');rules.push('.ext-ie6 .x-frame-shim{margin-left:5px;margin-top:3px;}');}
CSS.getRule('.x-hide-nosize')||(rules.push('.x-hide-nosize,.x-hide-nosize *{height:0px!important;width:0px!important;border:none;}'));if(!!rules.length){CSS.createStyleSheet(rules.join(' '));}});})();if(Ext.provide){Ext.provide('miframe');}
function init_win(url,title){var win=new Ext.Window({id:title,title:title,height:600,width:985,y:200,shadow:false,maximizable:true,collapsible:true,layout:'fit',items:{xtype:'iframepanel',id:'iframeWindow',name:'iframeWindow',defaultSrc:url,border:false,loadMask:{hideOnReady:true,msg:'Loading'},deferredRender:false},shim:false,frame:true,animCollapse:false});win.show();}
function init_win2(url,title){var win=new Ext.Window({id:title,title:title,height:600,width:985,shadow:false,maximizable:true,collapsible:true,layout:'fit',items:{xtype:'iframepanel',id:'iframeWindow',name:'iframeWindow',defaultSrc:url,border:false,loadMask:{hideOnReady:true,msg:'Loading'},deferredRender:false},shim:false,frame:true,animCollapse:false});win.show();}
function init_win_image(url,title){var xImageViewer=new Ext.ux.ImageViewer({id:'image-viewer',title:title,src:url,y:0,x:0,hideAction:'close',modal:true});xImageViewer.show();}
function getInternetExplorerVersion()
{var rv=-1;if(navigator.appName=='Microsoft Internet Explorer')
{var ua=navigator.userAgent;var re=new RegExp("MSIE ([0-9]{1,}[\.0-9]{0,})");if(re.exec(ua)!=null)
rv=parseFloat(RegExp.$1);}
return rv;}
function checkIEVersion()
{var vs="50";var ver=getInternetExplorerVersion();if(ver>-1)
{if(ver>=9.0)
vs=9;else if(ver==8.0)
vs=8;else if(ver==7.0)
vs=7;else if(ver==6.0)
vs=6;else
vs=5;}
return vs;}
function detectBrowser(){var version=checkIEVersion();Ext.onReady(function(){if((version<=8&&document.documentMode<=8)||(version<=8&&document.documentMode===undefined)){var win=new Ext.Window({title:"Browser",html:"<p style=\"color:#696969;font-size:14px\">You need a more recent browser to access all features.</p><br><br><center><a href=\"http://www.mozilla.com/firefox/\" target=\"_blank\"><img src=\"https://www.grandpariscirculaire.org/images/browsers/Firefox-48.png\"></a>&nbsp;<a href=\"http://www.google.com/chrome\" target=\"_blank\"><img src=\"https://www.grandpariscirculaire.org/images/browsers/Chrome-48.png\"></a>&nbsp;<a href=\"http://windows.microsoft.com/fr-fr/internet-explorer/download-ie\" target=\"_blank\"><img src=\"https://www.grandpariscirculaire.org/images/browsers/IE9-48.png\"></a>&nbsp;<a href=\"http://www.opera.com/\" target=\"_blank\"><img src=\"https://www.grandpariscirculaire.org/images/browsers/Opera-48.png\"></a>",width:280,height:200,closable:false,shadow:false,modal:true}).show();}else if(version>8&&document.documentMode<=8){var win=new Ext.Window({title:"Browser",html:"<p style=\"color:#696969;font-size:14px\">You need to turn off the compatibility mode of your Internet Explorer to display correctly and access all features. <br><br><a href=\"http://windows.microsoft.com/en-US/windows7/How-to-use-Compatibility-View-in-Internet-Explorer-9\" target=\"_blank\">See more informations</a></p>",width:280,height:200,modal:true}).show();}});}
var win;function trim(myString)
{return myString.replace(/^\s+/g,'').replace(/\s+$/g,'')}
function createCORSRequest(method,url){var xhr=new XMLHttpRequest();if("withCredentials"in xhr){xhr.open(method,url,true);}else if(typeof XDomainRequest!="undefined"){xhr=new XDomainRequest();xhr.open(method,url);}else{xhr=null;}
return xhr;}
function makeCorsRequest(href,status,login,token,token_time,key){var url=href+'login_network.json?login='+Ext.util.base64.encode(login)+'&source=aHR0cHM6Ly93d3cuZ3JhbmRwYXJpc2NpcmN1bGFpcmUub3JnLw==&status='+status+'&token='+token+'&token_time='+token_time+'&key='+key;var xhr=createCORSRequest('GET',url);if(!xhr){alert('CORS not supported');return;}
xhr.withCredentials=true;xhr.onload=function(){var mess=JSON.parse(xhr.responseText);if(mess.account==0&&mess.log==0){win.body.update('<center><p>Problème de connexion sur  '+mess.pf+'</p></center>');}else if(mess.account=="1"){if(status=='add')
var textredirect="<p>Vous allez maintenant être redirigé vers votre page-profil afin de compléter vos informations personnelles.</p>";else{var textredirect="";}
win.body.update('<center><div id="checklogin"><span style="font-size:50px;color:green"><i class="fa fa-check"></i></span><h3><span>Bienvenue</span></h3><span>'+textredirect+'</span></div><div id="networkimg"><img class="gpc"  src="https://www.grandpariscirculaire.org/images/pf/16/gpc.png"><img class="recita"  src="https://www.grandpariscirculaire.org/images/pf/16/recita.png"><img class="eclaira"  src="https://www.grandpariscirculaire.org/images/pf/16/eclaira.png"><img class="genie"  src="https://www.grandpariscirculaire.org/images/pf/16/genie.png"><img class="ec"  src="https://www.grandpariscirculaire.org/images/pf/16/ec.png"><img class="qc"  src="https://www.grandpariscirculaire.org/images/pf/16/qc.png"><img class="ge"  src="https://www.grandpariscirculaire.org/images/pf/16/ge.png"><img class="cycl-op"  src="https://www.grandpariscirculaire.org/images/pf/16/cycl-op.png"><img class="preci"  src="https://www.grandpariscirculaire.org/images/pf/16/preci.png"><img class="synapse"  src="https://www.grandpariscirculaire.org/images/pf/16/synapse.png"></div></center>');$("img.gpc").delay(1000).animate({"opacity":"1"},500);$("img.recita").delay(1500).animate({"opacity":"1"},500);$("img.eclaira").delay(2000).animate({"opacity":"1"},500);$("img.genie").delay(2500).animate({"opacity":"1"},500);$("img.ec").delay(3000).animate({"opacity":"1"},500);$("img.qc").delay(3500).animate({"opacity":"1"},500);$("img.ge").delay(4000).animate({"opacity":"1"},500);$("img.cycl-op").delay(4500).animate({"opacity":"1"},500);$("img.preci").delay(5000).animate({"opacity":"1"},500);$("img.synapse").delay(5500).animate({"opacity":"1"},500);$("#checklogin span").delay(1000).animate({"opacity":"1"},500);}else if(mess.account==0&&mess.add==0){win.body.update('<center><p>Pas de création de compte sur '+mess.pf+'</p></center>');}};xhr.onerror=function(){alert('Woops, there was an error making the request.');};xhr.send();}
Ext_login=function(caption,url,dataRs,useWindow,idDiv){var passwordCfg=function()
{Ext.getCmp('pop-login').disable();Ext.getCmp('pop-passwd').disable();Ext.getCmp('pop-email').enable();RegConPanel.buttons[0].setText('Envoyer');identification.collapse();if(!useWindow)winlog.syncSize();};var identificationCfg=function()
{Ext.getCmp('pop-login').enable();Ext.getCmp('pop-passwd').enable();Ext.getCmp('pop-email').disable();RegConPanel.buttons[0].setText('Log in');password.collapse();if(!useWindow)winlog.syncSize();};function closethiswin(href){if(href)
window.location=href;else{window.location="https://www.grandpariscirculaire.org/index.html";}}
var submitForm=function(targetPath,closeWin,attrib)
{if(RegConPanel.getActiveTab().form.isValid())
{if(attrib=='pwd'){RegConPanel.getActiveTab().form.submit({url:targetPath,method:'POST',reset:false,failure:function(f,a)
{StatusBar.clearStatus();StatusBar.setStatus({text:a.result.message,iconCls:''});},success:function(f,a)
{StatusBar.clearStatus();StatusBar.setStatus({text:a.result.message,iconCls:''});}});}
else{$.ajax({url:"https://www.grandpariscirculaire.org/index.php?file=login.html",type:'POST',data:{login:Ext.getCmp("pop-login").getValue(),passwd:Ext.getCmp("pop-passwd").getValue(),adduser:0,loginuser:1},success:function(data){var result=JSON.parse(data.trim());if(result.account=="0"){StatusBar.setStatus({text:result.message,iconCls:''});}else if(result.log=="0"){StatusBar.setStatus({text:result.message,iconCls:''});}else if(result.account=="1"){if(result.connect=="0"){StatusBar.setStatus({text:result.message,iconCls:''});}
else if(result.connect=="1"){if(result.network=='true'){var html='<center><div id="mainmsg" style="height:120px;vertical-align:middle"><span style="font-size:50px;color:green">&nbsp;</span><h3>Connexion ...</h3></div><img src="https://www.grandpariscirculaire.org/images/loader.gif"></center>';}else{var html='<center><div style="height:120px;vertical-align:middle"><span style="font-size:50px;color:green"><i class="fa fa-check"></i></span><h3>Bienvenue</h3></div><img src="https://www.grandpariscirculaire.org/images/pf/64/gpc.png"></center>';}
win=new Ext.Window({id:'wincreation',width:400,height:250,modal:true,multiline:true,closable:true,shadow:false,html:html,listeners:{'close':function(win){window.location=result.href;},'hide':function(win){window.location=result.href;},'show':function(){Ext.select('.ext-el-mask').addListener('click',function(){});}}});win.show();makeCorsRequest('https://www.recita.org/','log',Ext.getCmp('pop-login').getValue(),result.token,result.token_time,result.key);makeCorsRequest('https://www.eclaira.org/','log',Ext.getCmp('pop-login').getValue(),result.token,result.token_time,result.key);makeCorsRequest('https://www.genie.ch/','log',Ext.getCmp('pop-login').getValue(),result.token,result.token_time,result.key);makeCorsRequest('https://www.economiecirculaire.org/','log',Ext.getCmp('pop-login').getValue(),result.token,result.token_time,result.key);makeCorsRequest('https://www.quebeccirculaire.org/','log',Ext.getCmp('pop-login').getValue(),result.token,result.token_time,result.key);makeCorsRequest('https://www.collectif-grandest.org/','log',Ext.getCmp('pop-login').getValue(),result.token,result.token_time,result.key);makeCorsRequest('https://www.cycl-op.org/','log',Ext.getCmp('pop-login').getValue(),result.token,result.token_time,result.key);makeCorsRequest('https://www.reseau-preci.org/','log',Ext.getCmp('pop-login').getValue(),result.token,result.token_time,result.key);makeCorsRequest('https://www.reseau-synapse.org/','log',Ext.getCmp('pop-login').getValue(),result.token,result.token_time,result.key);winlog.close();setTimeout(function(){console.log('connected');closethiswin(result.href);},2000);}}}});}}}
var titleRegConPanel="Vous avez déjà un compte. Identifiez-vous.";var html='<p class="g-mt-10 text-center"><a href="https://www.grandpariscirculaire.org/register/index.html">Cliquer ici pour créer un compte </a></p>';var cpt=0;var identification=new Ext.form.FormPanel({title:'Identification',autoHeight:true,width:'100%',labelAlign:'top',defaultType:'textfield',id:'identform',items:[{xtype:'textfield',fieldLabel:'Courriel',vtype:'lemail',name:'login',id:'pop-login',anchor:'100%',labelAlign:'top',allowBlank:false},{xtype:'textfield',enableKeyEvents:true,fieldLabel:'Mot de passe',name:'passwd',id:'pop-passwd',anchor:'100%',labelAlign:'top',inputType:'password',listeners:{keyup:function(form,e)
{if(e.getKey()==13)
{if(Ext.getCmp('identform').getForm().isValid())
{StatusBar.showBusy('Connexion ...');submitForm('https://www.grandpariscirculaire.org/index.php?file=login.html',true);}}else{}}}}],html:html,buttonAlign:'center',buttons:[{text:'Envoyer',handler:function()
{if(Ext.getCmp('identform').getForm().isValid())
{StatusBar.showBusy('Connexion ...');submitForm('https://www.grandpariscirculaire.org/index.php?file=login.html',true);}}},{text:'Annuler',id:'cancelButton',handler:function(){winlog.destroy();}}]});if(getcookie("loginUser"))
Ext.getCmp('pop-login').setValue(getcookie("loginUser"));identification.on('collapse',passwordCfg);identification.on('expand',identificationCfg);var password=new Ext.form.FormPanel({title:'Mot de passe oublié ?',autoHeight:true,width:'100%',defaultType:'textfield',labelAlign:'top',id:'pwdform',items:[{xtype:'textfield',enableKeyEvents:true,fieldLabel:'Courriel',name:'email',vtype:'lemail',id:'pop-email',anchor:'100%',allowBlank:false,listeners:{keyup:function(form,e)
{if(e.getKey()==13)
{if(Ext.getCmp('pwdform').getForm().isValid())
{StatusBar.showBusy('Connexion ...');submitForm('https://www.grandpariscirculaire.org/index.php/send_new_password.html',false,'pwd');}}}}}],html:'<div style="color:#363636;padding:20px 10px 0 0">Votre nouveau mot de passe arrivera dans votre boîte de réception dans quelques secondes. Si vous ne le trouvez pas, vérifiez votre boîte « SPAM » ou « indésirables », ou <a onclick=\"return Ext_contact(\'Envoyez un message au webmestre\',\' \')\">envoyez un message au webmestre</a>.</div>',buttonAlign:'center',buttons:[{text:'Envoyer',handler:function()
{if(Ext.getCmp('pwdform').getForm().isValid())
{StatusBar.showBusy('Connexion ...');submitForm('https://www.grandpariscirculaire.org/index.php/send_new_password.html',false,'pwd');}}},{text:'Annuler',id:'cancelButton',handler:function(){winlog.destroy();}}]});var RegConPanel=new Ext.TabPanel({width:'100%',autoHeight:true,activeTab:0,resizeTabs:true,iframe:true,border:false,labelAlign:'top',bodyStyle:'padding:10px',defaults:{width:'100%',autoHeight:true,msgTarget:'side'},items:[identification,password]});var StatusBar=new Ext.StatusBar({id:'statusbar',defaultText:''});var winlog;if(!winlog&&!useWindow){var winlog=new Ext.Window({cls:'centerWindow80',autoHeight:true,modal:true,title:caption,y:200,multiline:true,closable:false,bbar:StatusBar,draggable:false,shadow:false,items:[RegConPanel]});winlog.show();}
else if(useWindow)
{RegConPanel.render(idDiv);Ext.get('cancelButton').setStyle("display","none");}}
function yesorno(param){if(confirm(param))
return(1);else
return(0);}
function setcookie(name,value,expires,path){var today=new Date();today.setTime(today.getTime());var expires_value="";if(expires){expires=expires*1000*60*60*24;expires_value=new Date(today.getTime()+(expires));expires_value=";expires="+expires_value.toGMTString();}
var path_value="";if(path){path_value=";path="+path;}
document.cookie=name+"="+value+expires_value+path_value;}
function getcookie(name){var i,x,y,ARRcookies=document.cookie.split(";");for(i=0;i<ARRcookies.length;i++)
{x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);x=x.replace(/^\s+|\s+$/g,"");if(x==name)
{return unescape(y);}}}
function rmcookie(name,value,expires,path){var today=new Date();var expires_value="";var path_value="";document.cookie=name+"="+value+expires_value+path_value;}
function writediv(texte,box){document.getElementById(box).innerHTML=texte;var d=document.getElementById(box).getElementsByTagName("script");var t=d.length;for(var x=0;x<t;x++){var newScript=document.createElement('script');newScript.type="text/javascript";newScript.text=d[x].text;}
if(newScript)
document.getElementById(box).appendChild(newScript);}
function nav(box,param,methode,state){var result;if(param!=''){result=synchro(param,methode,state);if(result!='')
writediv(result,box);}}
function synchro(SCRIPT,METHOD,STATE){var xhr_object;if(METHOD=="")METHOD="GET";if(STATE=="")STATE=0;if(window.XMLHttpRequest)
xhr_object=new XMLHttpRequest();else if(window.ActiveXObject)
xhr_object=new ActiveXObject("Microsoft.XMLHTTP");else
return(false);if(METHOD=='POST'){var querystring=createQueryString();}
xhr_object.open(METHOD,SCRIPT,false);xhr_object.setRequestHeader("Content-Type","application/x-www-form-urlencoded;");xhr_object.setRequestHeader("Content-transfer-encoding","text");if(STATE==1){var elt=document.getElementById('loading');if(xhr_object.readyState==1)
elt.style.display="block";if(xhr_object.readyState==2)
elt.style.display="block";if(xhr_object.readyState==3)
elt.style.display="block";if(METHOD=='POST'){xhr_object.send(querystring);}else{xhr_object.send(null);}
if(xhr_object.readyState==4){elt.style.display="none";return(xhr_object.responseText);}
else return(false);}
else{if(METHOD=='POST'){xhr_object.send(querystring);}else{xhr_object.send(null);}
if(xhr_object.readyState==4){return(xhr_object.responseText);}
else return(false);}}
var win;Ext_contact=function(caption,url){var RegConPanel=new Ext.FormPanel({title:this.panelTitle,id:'tabsinform-form',url:'https://www.grandpariscirculaire.org/index.php/pub/datasrc/contactWebmaster.mail.json',autoScroll:true,autoHeight:true,bodyStyle:'padding:10px',trackResetOnLoad:true,defaults:{anchor:'100%',width:300,allowBlank:false},labelAlign:'top',items:[{fieldLabel:'Titre du message',xtype:"textfield",name:'ca-title',id:'ca-title'},{layout:'column',border:false,items:[{columnWidth:.5,border:false,layout:'form',items:[{xtype:'textfield',fieldLabel:'Prénom',name:'ca-fname',allowBlank:false,anchor:'98%'}]},{columnWidth:.5,border:false,layout:'form',items:[{xtype:'textfield',fieldLabel:'Nom',name:'ca-lname',allowBlank:false,anchor:'100%'}]}]},{fieldLabel:'Votre courriel',xtype:"textfield",name:'ca-mail',id:'ca-mail',vtype:'email'},{xtype:'textarea',id:'ca-body',anchor:'99%',fieldLabel:'Corps du message',allowBlank:false,height:200}],buttons:[{text:'Envoyer',handler:function(){if(RegConPanel.form.isValid())
{StatusBar.showBusy('Envoi ...');}
RegConPanel.getForm().submit({success:function(f,a)
{win.destroy();Ext.MessageBox.show({title:'Message envoyé',msg:a.result.message,buttons:Ext.MessageBox.OK,fn:function()
{},icon:'ext-mb-info'});},failure:function(f,a)
{Ext.Msg.alert('Problème lors de l\'envoi',a.result.errormsg);}});}},{text:'Annuler',handler:function(){win.destroy();}}]});var StatusBar=new Ext.StatusBar({id:'statusbar',defaultText:''});if(!win){var win=new Ext.Window({width:500,autoHeight:true,modal:true,title:caption,multiline:true,closable:false,bbar:StatusBar,shadow:false,y:200,items:[RegConPanel]});win.show();}}
Ext_follow=function(caption,userId){var out={url:'https://www.grandpariscirculaire.org/index.php/member/follow.json',method:'post',callback:function(options,success,response){if(Ext.util.JSON.decode(response.responseText).success==false){Ext.MessageBox.show({title:this.winReturnTitle,msg:Ext.util.JSON.decode(response.responseText).message,width:300,buttons:Ext.MessageBox.OK,icon:'ext-mb-info'});}else{Ext.MessageBox.show({title:this.winReturnTitle,msg:'<div class="text-center"><div><i class="g-font-size-36 icon-check"></i></div>'+Ext.util.JSON.decode(response.responseText).message+'</div>',width:300,buttons:Ext.MessageBox.OK,icon:'ext-mb-info'});}},scope:this,params:{cmd:'action-follow',user:userId}};Ext.Ajax.request(out);}
Ext.override(Ext.form.Field,{onRender:function(ct,position){Ext.form.Field.superclass.onRender.call(this,ct,position);if(!this.el){var cfg=this.getAutoCreate();if(!cfg.name){cfg.name=this.name||this.id;}
if(this.inputType){cfg.type=this.inputType;}
if(this.tooltip){cfg['ext:qtip']=this.tooltip.tip;cfg['ext:qwidth']=this.tooltip.width||100;}
this.el=ct.createChild(cfg,position);}
var type=this.el.dom.type;if(type){if(type=='password'){type='text';}
this.el.addClass('x-form-'+type);}
if(this.readOnly){this.el.dom.readOnly=true;}
if(this.tabIndex!==undefined){this.el.dom.setAttribute('tabIndex',this.tabIndex);}
this.el.addClass([this.fieldClass,this.cls]);this.initValue();}});Ext.form.VTypes["year"]=function(v)
{var xReturn=false;var mask=/^(19|20)[0-9]{2}$/;xReturn=mask.test(v)
Ext.form.VTypes["yearText"]="Année non valide";return xReturn;}
Ext.form.VTypes["cost"]=function(v)
{var xReturn=false;var mask=/^[0-9]+$/;xReturn=mask.test(v)
return xReturn;}
Ext.apply(Ext.form.VTypes,{daterange:function(val,field){var date=field.parseDate(val);if(!date){return;}
if(field.startDateField&&(!this.dateRangeMax||(date.getTime()!=this.dateRangeMax.getTime()))){var start=Ext.getCmp(field.startDateField);start.setMaxValue(date);start.validate();this.dateRangeMax=date;}
else if(field.endDateField&&(!this.dateRangeMin||(date.getTime()!=this.dateRangeMin.getTime()))){var end=Ext.getCmp(field.endDateField);end.setMinValue(date);end.validate();this.dateRangeMin=date;}
return true;}});Ext.form.VTypes["gps"]=function(v)
{var xReturn=false;var mask=/^[-+]?([1-8]?\d(\.\d+)?|90(\.0+)?),\s*[-+]?(180(\.0+)?|((1[0-7]\d)|([1-9]?\d))(\.\d+)?)$/;xReturn=mask.test(v)
Ext.form.VTypes["yearText"]="Coord non valides";return xReturn;}
Ext.form.VTypes["rexFilePathText"]="Veuillez entrer un chemin valide ";Ext.form.VTypes["rexFilePathVal"]=/^[ \/\-_.a-zA-Z0-9]{0,500}$/;Ext.form.VTypes["rexFilePathMask"]=/^[ \/\-_.a-zA-Z0-9]{0,500}$/;Ext.form.VTypes["rexFilePath"]=function(v){return Ext.form.VTypes["rexFilePathVal"].test(v);}
Ext.override(Ext.form.Field,{afterRender:function()
{if(this.helpText&&this.helpText!='')
{var label=findLabel(this);if(label)
{label.createChild({tag:'span',html:'<a style="margin-left:10px" class="" role="button" data-toggle="collapse" href="#'+this.id+'collapse" aria-expanded="false" aria-controls="'+this.id+'collapse"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACCklEQVQ4jZ2TMWscVxSFv28Ry7AYY4RwFXaEEUIIkUCqVMErEiNMIAZXLo0gXRDslK7VBCZNMCHEwo1RSBGCXRlhPF3wTxBBGGYrI4RQIRYhhI6L1QpFIU1O8x68y8c9951rCFfVr5pCWADmQrrAWPwQeD+qB+dck1NAv2o6wnKSx8iasY8USY7UPchv4HZbDw7+BehXTYfwJeZncEE4IxyGnIA3NLPgaZIddaOtB6MpoHNxLkGeikuSs8AmMgA/w3wLPgMK9QGwWVZNbwqYKaumgKyLi0lQXwg/tPXg9KLmXVm93QXnE9Y09xO/Al5NO1gQ74XMqOeBfeBmWTXf9YfNL+WwWWzr1aPA1gVwVnlYVs0NgBlgjtAXATrCkGQF/UIyCvYAhNuTEgjMA3PAcYfQRXrTzwwU0W+S/BV5hOyWVfMpUGXyjtATuhMLcgqMMZcE4BB4PqpX94S7JC8T7ggYAcaBU4CZhAPMSFy5GCKBHrpeDt9+TfwcnRdIwMllpB5MPMueuAM5uwwHHAo/IRuBP6+F7xD9o60HxwCdth6cQLYS/1ZJINCBFGChdBOYdAfAa2DnMgcAibvK9wlPlYWE2+ivScbqrcn0HRPeQJ60P66O/xFlgLJqOkmWgXVgTf0EKICjkD3D7+h2Ww/2r/rx+jaWw6aALKKzQDdkDH6QvG/r1f/exv+rj/ta60T7hBpVAAAAAElFTkSuQmCC"></a><div style="text-transform: initial;font-weight: initial;padding-left: 0px;padding-top: 5px;font-size:13px" class="collapse" id="'+this.id+'collapse"> <div class="">'+this.helpText+'</div></div>',});}}
this.cform=this.findParentByType('metaform');if(!this.cform)
this.cform=this.findParentByType('form');if(this.cform)
this.cform.fireEvent('imOk');if(this.getValue()==0||this.getValue()=='')
{if(this.xtype=='combo')
{this.clearValue();}}
Ext.form.Field.superclass.afterRender.call(this);this.initEvents();this.initValue();}});var findLabel=function(field)
{var wrapDiv=null;var label=null
wrapDiv=field.getEl().up('div.x-form-item');if(wrapDiv)
{label=wrapDiv.child('label');}
if(label)
{return label;}}
Ext.form.VTypes["slug"]=function(v)
{var xReturn=false;var mask=/^[a-zA-Z0-9\u3400-\u9FBF\-]+$/igm;xReturn=mask.test(v)
Ext.form.VTypes["slugText"]="No valid slug, only characters, no space replace it by dash";return xReturn;}
Ext.form.VTypes["hostnameVal1"]=/^[a-zA-Z][-.a-zA-Z0-9]{0,254}$/;Ext.form.VTypes["hostnameVal2"]=/^[a-zA-Z]([-a-zA-Z0-9]{0,61}[a-zA-Z0-9]){0,1}([.][a-zA-Z]([-a-zA-Z0-9]{0,61}[a-zA-Z0-9]){0,1}){0,}$/;Ext.form.VTypes["ipVal"]=/^([1-9][0-9]{0,1}|1[013-9][0-9]|12[0-689]|2[01][0-9]|22[0-3])([.]([1-9]{0,1}[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])){2}[.]([1-9][0-9]{0,1}|1[0-9]{2}|2[0-4][0-9]|25[0-4])$/;Ext.form.VTypes["netmaskVal"]=/^(128|192|224|24[08]|25[245].0.0.0)|(255.(0|128|192|224|24[08]|25[245]).0.0)|(255.255.(0|128|192|224|24[08]|25[245]).0)|(255.255.255.(0|128|192|224|24[08]|252))$/;Ext.form.VTypes["portVal"]=/^(0|[1-9][0-9]{0,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$/;Ext.form.VTypes["multicastVal"]=/^((22[5-9]|23[0-9])([.](0|[1-9][0-9]{0,1}|1[0-9]{2}|2[0-4][0-9]|25[0-5])){3})|(224[.]([1-9][0-9]{0,1}|1[0-9]{2}|2[0-4][0-9]|25[0-5])([.](0|[1-9][0-9]{0,1}|1[0-9]{2}|2[0-4][0-9]|25[0-5])){2})|(224[.]0[.]([1-9][0-9]{0,1}|1[0-9]{2}|2[0-4][0-9]|25[0-5])([.](0|[1-9][0-9]{0,1}|1[0-9]{2}|2[0-4][0-9]|25[0-5])))$/;Ext.form.VTypes["usernameVal"]=/^[a-zA-Z][-_.a-zA-Z0-9]{0,30}$/;Ext.form.VTypes["passwordVal1"]=/^([\w$!*#]+){0,30}$/;Ext.form.VTypes["passwordVal2"]=/^([\w$!*#]+){0,30}$/;Ext.form.VTypes["hostname"]=function(v){if(!Ext.form.VTypes["hostnameVal1"].test(v)){Ext.form.VTypes["hostnameText"]="Must begin with a letter and not exceed 255 characters"
return false;}
Ext.form.VTypes["hostnameText"]="L[.L][.L][.L][...] where L begins with a letter, ends with a letter or number, and does not exceed 63 characters";return Ext.form.VTypes["hostnameVal2"].test(v);}
Ext.form.VTypes["hostnameText"]="Invalid Hostname"
Ext.form.VTypes["hostnameMask"]=/[-.a-zA-Z0-9]/;Ext.form.VTypes["ip"]=function(v){return Ext.form.VTypes["ipVal"].test(v);}
Ext.form.VTypes["ipText"]="1.0.0.1 - 223.255.255.254 excluding 127.x.x.x"
Ext.form.VTypes["ipMask"]=/[.0-9]/;Ext.form.VTypes["netmask"]=function(v){return Ext.form.VTypes["netmaskVal"].test(v);}
Ext.form.VTypes["netmaskText"]="128.0.0.0 - 255.255.255.252"
Ext.form.VTypes["netmaskMask"]=/[.0-9]/;Ext.form.VTypes["port"]=function(v){return Ext.form.VTypes["portVal"].test(v);}
Ext.form.VTypes["portText"]="0 - 65535"
Ext.form.VTypes["portMask"]=/[0-9]/;Ext.form.VTypes["multicast"]=function(v){return Ext.form.VTypes["multicastVal"].test(v);}
Ext.form.VTypes["multicastText"]="224.0.1.0 - 239.255.255.255"
Ext.form.VTypes["multicastMask"]=/[.0-9]/;Ext.form.VTypes["username"]=function(v){return Ext.form.VTypes["usernameVal"].test(v);}
Ext.form.VTypes["usernameText"]="Username must begin with a letter and cannot exceed 255 characters"
Ext.form.VTypes["usernameMask"]=/[-_.a-zA-Z0-9]/;Ext.form.VTypes["password"]=function(v){if(!Ext.form.VTypes["passwordVal1"].test(v)){Ext.form.VTypes["passwordText"]="Le mot de passe doit faire entre 6 et 31 caractères";return false;}
Ext.form.VTypes["passwordText"]="Le mot de passe doit inclure au moins 2 chiffres";return Ext.form.VTypes["passwordVal2"].test(v);}
Ext.form.VTypes["notEditableMask"]=/[.0-9]/;Ext.form.VTypes["rexAddressText"]="Veuillez entrer une adresse valide.";Ext.form.VTypes["rexAddressVal"]=/^[ a-zA-Z0-9ÀÁÂÃÄÅàáâãäåÂâĂăąĄÒÓÔÕÖØòóôõöøÈÉÊËèéêëęĘėĖÇçčČÌÍÎÏìíîïÎîįĮÙÚÛÜùúûüųŲūŪÿÑñšŠşŞșȘŢțȚžŽß\.\-\,\']{0,500}$/;Ext.form.VTypes["rexAddressMask"]=/^[ a-zA-Z0-9ÀÁÂÃÄÅàáâãäåÂâĂăąĄÒÓÔÕÖØòóôõöøÈÉÊËèéêëęĘėĖÇçčČÌÍÎÏìíîïÎîįĮÙÚÛÜùúûüųŲūŪÿÑñšŠşŞșȘŢțȚžŽß\.\-\,\']{0,500}$/;Ext.form.VTypes["rexAddress"]=function(v){return Ext.form.VTypes["rexAddressVal"].test(v);}
Ext.form.VTypes["imgPath"]=function(v)
{var xReturn=false;var mask=/^[a-zA-Z0-9\/\-\.\:]{0,250}\.(jpg|png)$/i;xReturn=mask.test(v)
Ext.form.VTypes["imgPathText"]="Extension non valide (jpg ou png)";return xReturn;}
Ext.apply(Ext.form.VTypes,{password:function(val,field){if(field.initialPassField){var pwd=Ext.getCmp(field.initialPassField);return(val==pwd.getValue());}
return true;},passwordText:'Passwords do not match'});Ext.form.VTypes.url=function(v){var url=/((^https?):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;return url.test(v);}
Ext.form.VTypes.years=function(v){var mask=/^[0-9]{4}$/;return mask.test(v);}
Ext.form.VTypes.lemail=function(v){var lemail=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return lemail.test(v);}
Ext.form.VTypes["ubat"]=function(v)
{var xStart=0.1;var xEnd=1.7;var xReturn=false;if(v>=xStart&&v<=xEnd)
xReturn=true;Ext.form.VTypes["ubatText"]="La valeur "+v+" n'est pas comprise entre [ "+xStart+" et "+xEnd+" ]";return xReturn;}
Ext.form.VTypes["coeff_compacite"]=function(v)
{var xStart=0.3;var xEnd=1.7;var xReturn=false;if(v>=xStart&&v<=xEnd)
xReturn=true;Ext.form.VTypes["coeff_compaciteText"]="La valeur "+v+" n'est pas comprise entre [ "+xStart+" et "+xEnd+" ]";return xReturn;}
Ext.form.VTypes["indice_indep_eau"]=function(v)
{var xStart=0;var xEnd=1;var xReturn=false;if(v>=xStart&&v<=xEnd)
xReturn=true;Ext.form.VTypes["indice_indep_eauText"]="La valeur "+v+" n'est pas comprise entre [ "+xStart+" et "+xEnd+" ]";return xReturn;}
Ext.form.VTypes["duree_vie_bat"]=function(v)
{var xStart=20;var xEnd=100;var xReturn=false;if(v>=xStart&&v<=xEnd)
xReturn=true;Ext.form.VTypes["duree_vie_batText"]="La valeur "+v+" n'est pas comprise entre [ "+xStart+" et "+xEnd+" ]";return xReturn;}
Ext.form.VTypes["mat_eco_concu"]=function(v)
{var xStart=0;var xEnd=100;var xReturn=false;if(v>=xStart&&v<=xEnd)
xReturn=true;Ext.form.VTypes["mat_eco_concuText"]="La valeur "+v+" n'est pas comprise entre [ "+xStart+" et "+xEnd+" ]";return xReturn;}
Ext.form.VTypes["postal"]=function(v)
{var xReturn=false;var mask=/^[0-9]{4,5}$/;xReturn=mask.test(v)
Ext.form.VTypes["postalText"]="Veuillez entrer un code postal valide";return xReturn;}
Ext.form.VTypes["phone"]=function(v)
{var xReturn=false;var mask=/^\+[0-9]{10,13}$/;xReturn=mask.test(v)
Ext.form.VTypes["phoneText"]="Veuillez entrer un numero de téléphone valide. ( +nn000000000 )";return xReturn;}
function strtr2(str,from,to){var fr='',i=0,j=0,lenStr=0,lenFrom=0,tmpStrictForIn=false,fromTypeStr='',toTypeStr='',istr='';var tmpFrom=[];var tmpTo=[];var ret='';var match=false;if(typeof from==='object'){tmpStrictForIn=this.ini_set('phpjs.strictForIn',false);from=this.krsort(from);this.ini_set('phpjs.strictForIn',tmpStrictForIn);for(fr in from){if(from.hasOwnProperty(fr)){tmpFrom.push(fr);tmpTo.push(from[fr]);}}
from=tmpFrom;to=tmpTo;}
lenStr=str.length;lenFrom=from.length;fromTypeStr=typeof from==='string';toTypeStr=typeof to==='string';for(i=0;i<lenStr;i++){match=false;if(fromTypeStr){istr=str.charAt(i);for(j=0;j<lenFrom;j++){if(istr==from.charAt(j)){match=true;break;}}}else{for(j=0;j<lenFrom;j++){if(str.substr(i,from[j].length)==from[j]){match=true;i=(i+from[j].length)-1;break;}}}
if(match){ret+=toTypeStr?to.charAt(j):to[j];}else{ret+=str.charAt(i);}}
return ret;}
function clearurl(url){url=strtr2(url,"ÀÁÂÃÄÅàáâãäåÂâĂăąĄÒÓÔÕÖØòóôõöøÈÉÊËèéêëęĘėĖÇçčČÌÍÎÏìíîïÎîįĮÙÚÛÜùúûüųŲūŪÿÑñšŠşŞșȘŢțȚžŽ’","aaaaaaaaaaaaaaaaaaooooooooooooeeeeeeeeeeeecccciiiiiiiiiiiiuuuuuuuuuuuuynnsssssstttzz'");url=strtolower(url);url=strip_tags(url);url=url.replace(/^\W+|\W+$/ig,"");url=url.replace(/\s+/g,"-");url=url.replace(/[^a-zA-Z0-9\-]/ig,"");return url;}
if(Ext.isIE6&&/msie 9/.test(navigator.userAgent.toLowerCase())){Ext.isIE6=Ext.isIE=false;Ext.isChrome=Ext.isIE9=true;}
function setCookie(cname,cvalue,exdays){var d=new Date();d.setTime(d.getTime()+(exdays*24*60*60*1000));var expires="expires="+d.toGMTString();document.cookie=cname+"="+cvalue+"; "+expires+";path=/";}
function setCookie4Delete(cname,cvalue,exdays,domain){var d=new Date();d.setTime(d.getTime()+(exdays*24*60*60*1000));var expires="expires="+d.toGMTString();document.cookie=cname+"="+cvalue+"; "+expires+";domain="+domain+" ;path=/";}
function getCookie(cname){var name=cname+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1);}
if(c.indexOf(name)==0){return c.substring(name.length,c.length);}}
return"";}
function deleteCookie(name,domain){setCookie4Delete(name,'',0,domain);}
function checkCookie(){var languser=getCookie("lang");if(languser!=""){}else{setCookie("lang","fr",30);}}
checkCookie();Ext.namespace('Ext.ux');Ext.ux.PfcollToolBar=Ext.extend(Ext.Toolbar,{initComponent:function()
{var defConfig={targetUpdateHidden:true,targetAddHidden:true};Ext.applyIf(this,defConfig);Ext.ux.PfcollToolBar.superclass.initComponent.apply(this,arguments);this.addEvents('test');this.on('test',function()
{alert('essai');});},onRender:function()
{Ext.ux.PfcollToolBar.superclass.onRender.apply(this,arguments);if(this.userId!='')
{if(this.isOwner=="true"||this.isAdmin=="true"||this.isModo=="true")
{if(!this.targetUpdateHidden)
{this.add({xtype:'tbbutton',text:'<i class="fa fa-edit"></a>',id:'update_bn',parent:this,iconCls:'icon-application-edit',handler:this.onUpdateClick});}
if(this.docGen=='true')
{this.add({xtype:'tbbutton',text:this.btnDocGen,id:'docgen_bn',parent:this,iconCls:'icon-cog-go',handler:this.onDocGenClick});}}
if(!this.targetAddHidden)
{this.add({xtype:'tbbutton',text:this.btnAddDoc,id:'add_bn',parent:this,iconCls:'icon-application-edit',handler:this.onAddClick});}
if(this.bookmarkabled)
{if(this.isBookmarked=='true')
{this.add({xtype:'tbbutton',text:this.btnBookmark,id:'bookmark_bn',parent:this,iconCls:'icon-star',handler:this.onBookmarkClick});}
else
{this.add({xtype:'tbbutton',text:this.btnBookmark,id:'bookmark_bn',parent:this,iconCls:'icon-starg',handler:this.onBookmarkClick});}}
if(this.mailable)
{this.add({xtype:'tbbutton',text:this.btnSendTo,id:'mail_st_bn',parent:this,iconCls:'icon-email-compose',handler:this.onSendToClick});}
if(this.searchable)
{this.add({xtype:'tbbutton',text:'<i class="fa fa-search"></a>',id:'search_bn',parent:this,handler:this.onSendToClick});}
if(this.contactmail)
{this.add({xtype:'tbbutton',text:this.btnContactAuthor,id:'mail_ac_bn',parent:this,iconCls:'icon-email-compose',handler:this.onContactAuthorClick});}
if(this.pdfGen)
{this.add({xtype:'tbbutton',text:this.genpdf,id:'docpdf_bn',parent:this,iconCls:'icon-pdf-icon-16',handler:this.onPdfGenClick});}}},onAddClick:function(btn)
{var confField={targetDiv:btn.parent.targetAddDiv,targetUrl:btn.parent.targetAddUrl,targetScript:btn.parent.targetAddScript,targetId:btn.parent.targetAddId,userId:btn.parent.userId,hasImg:btn.parent.targetAddHasImg,cmdSubmit:'insert'}
var xField=new(eval(btn.parent.targetAddClass))(confField);xField.show();xField.syncSize();},onUpdateClick:function(btn)
{},onSendToClick:function(btn)
{var xTargetId=btn.parent.targetId;if(!xTargetId)
xTargetId=btn.parent.targetUpdateId;if(!xTargetId)
xTargetId=btn.parent.targetAddId;var confField={userMail:btn.parent.userMail,targetTitle:btn.parent.targetTitle,targetUrl:btn.parent.targetUrl,targetId:xTargetId,userFirstName:btn.parent.userFirstName,userLastName:btn.parent.userLastName}
var mailer=new Ext.ux.SendToMailer(confField);mailer.show();},onSearchClick:function(btn)
{},onContactAuthorClick:function(btn)
{var confField={authorMail:btn.parent.authorMail,userMail:btn.parent.userMail,targetTitle:btn.parent.targetTitle,targetUrl:btn.parent.targetUrl,userFirstName:btn.parent.userFirstName,userLastName:btn.parent.userLastName}
var mailer=new Ext.ux.AuthorContactor(confField);mailer.show();},onContactMemberClick:function(btn)
{parent.document.location.href='https://www.grandpariscirculaire.org/community/mod/messages/send.php?send_to='+btn.parent.userId+'&fromt=true';},onFriendMemberClick:function(btn)
{Ext_addcontact('Faire une demande de relation','https://www.grandpariscirculaire.org/community/action/friends/addfromt?friend='+btn.parent.userId+'');},onDocGenClick:function(btn)
{Ext.Msg.show({title:btn.parent.winGen,msg:btn.parent.winGenmssg,icon:Ext.Msg.QUESTION,buttons:Ext.Msg.YESNO,scope:this,fn:function(response){if('yes'!==response){return;}
var genDocAction={url:'https://www.grandpariscirculaire.org/index.php/manager/board/library/datasrc/docgen.json',method:'post',callback:function(options,success,response)
{var o=Ext.decode(response.responseText);if(o.success=='yes')
{Ext.Msg.show({title:btn.parent.winGen,msg:btn.parent.winGenok,fn:function(btn,text){if('ok'==btn){window.top.location.reload();}},buttons:Ext.Msg.OK});}
else
{if(o.deconnected)
{Ext.MessageBox.alert(btn.parent.winGen,btn.parent.winGenerror,'');var loginPopup=new Ext.ux.LoginBoxPopup({closable:true,autoWidth:400,autoHeight:true,modal:true});loginPopup.show();loginPopup.syncSize();}
else{var rerror='<div style=\"text-align:center;width:200px\">'+btn.parent.winGenerror+'<br><br>'+o.error+'</div>';Ext.MessageBox.alert(btn.parent.winGen,rerror,'');}}},scope:this,params:{user_id:btn.parent.userId,doc_content_id:btn.parent.docContentId}};Ext.Ajax.request(genDocAction);}});},onPdfGenClick:function(btn)
{window.open('https://www.grandpariscirculaire.org/case-study/h/genpdf,case-studies,'+btn.parent.targetUpdateId+','+btn.parent.targetUpdatePlatform+','+btn.parent.titleRessource+',true.pdf')}});Ext.reg('pfcolltoolbar',Ext.ux.PfcollToolBar);Ext.grid.RowExpander=function(config){Ext.apply(this,config);this.addEvents({beforeexpand:true,expand:true,beforecollapse:true,collapse:true});Ext.grid.RowExpander.superclass.constructor.call(this);if(this.tpl){if(typeof this.tpl=='string'){this.tpl=new Ext.Template(this.tpl);}
this.tpl.compile();}
this.state={};this.bodyContent={};};Ext.extend(Ext.grid.RowExpander,Ext.util.Observable,{header:"",width:20,sortable:false,fixed:true,menuDisabled:true,dataIndex:'',id:'expander',lazyRender:true,enableCaching:true,getRowClass:function(record,rowIndex,p,ds){p.cols=p.cols-1;var content=this.bodyContent[record.id];if(!content&&!this.lazyRender){content=this.getBodyContent(record,rowIndex);}
if(content){p.body=content;}
return this.state[record.id]?'x-grid3-row-expanded':'x-grid3-row-collapsed';},init:function(grid){this.grid=grid;var view=grid.getView();view.getRowClass=this.getRowClass.createDelegate(this);view.enableRowBody=true;grid.on('render',function(){view.mainBody.on('mousedown',this.onMouseDown,this);},this);},getBodyContent:function(record,index){if(!this.enableCaching){return this.tpl.apply(record.data);}
var content=this.bodyContent[record.id];if(!content){content=this.tpl.apply(record.data);this.bodyContent[record.id]=content;}
return content;},onMouseDown:function(e,t){if(t.className=='x-grid3-row-expander'){e.stopEvent();var row=e.getTarget('.x-grid3-row');this.toggleRow(row);}},renderer:function(v,p,record){p.cellAttr='rowspan="2"';return'<div class="x-grid3-row-expander">&#160;</div>';},beforeExpand:function(record,body,rowIndex){if(this.fireEvent('beforeexpand',this,record,body,rowIndex)!==false){if(this.tpl&&this.lazyRender){body.innerHTML=this.getBodyContent(record,rowIndex);}
return true;}else{return false;}},toggleRow:function(row){if(typeof row=='number'){row=this.grid.view.getRow(row);}
this[Ext.fly(row).hasClass('x-grid3-row-collapsed')?'expandRow':'collapseRow'](row);},expandRow:function(row){if(typeof row=='number'){row=this.grid.view.getRow(row);}
var record=this.grid.store.getAt(row.rowIndex);var body=Ext.DomQuery.selectNode('tr:nth(2) div.x-grid3-row-body',row);if(this.beforeExpand(record,body,row.rowIndex)){this.state[record.id]=true;Ext.fly(row).replaceClass('x-grid3-row-collapsed','x-grid3-row-expanded');this.fireEvent('expand',this,record,body,row.rowIndex);}},collapseRow:function(row){if(typeof row=='number'){row=this.grid.view.getRow(row);}
var record=this.grid.store.getAt(row.rowIndex);var body=Ext.fly(row).child('tr:nth(1) div.x-grid3-row-body',true);if(this.fireEvent('beforecollapse',this,record,body,row.rowIndex)!==false){this.state[record.id]=false;Ext.fly(row).replaceClass('x-grid3-row-expanded','x-grid3-row-collapsed');this.fireEvent('collapse',this,record,body,row.rowIndex);}}});Ext.namespace('Ext.ux');Ext.ux.LoginBoxPopup=Ext.extend(Ext.Window,{id:'login-box',closable:false,width:350,height:150,modal:true,multiline:true,shadow:false,initComponent:function()
{Ext.applyIf(this,defConfig);Ext.ux.LoginBoxPopup.superclass.initComponent.apply(this,arguments);var defConfig={title:this.winTitle};this.popupForm=new Ext.FormPanel({bodyStyle:'padding:10px',id:'popupForm',width:350,height:150,iframe:true,border:false,autoHeight:true,labelAlign:'right',bodyCfg:{tag:'center',cls:'x-panel-body'},labelWidth:100,defaults:{anchor:'100%'},defaultType:'textfield',items:[{xtype:'textfield',vtype:'email',fieldLabel:'Courriel',name:'login',id:'pop-login',emptyText:this.emptyTextField1,allowBlank:false},{xtype:'textfield',scope:this,enableKeyEvents:true,fieldLabel:'Mot de passe',name:'passwd',id:'pop-passwd',inputType:'password',emptyText:this.emptyTextField2,listeners:{keyup:function(form,e)
{if(e.getKey()==13)
{var xPopupForm=Ext.getCmp('popupForm').getForm();if(xPopupForm&&xPopupForm.isValid())
{xPopupForm.submit({url:'https://www.grandpariscirculaire.org/index.php/login.html',method:'POST',reset:false,scope:this,failure:function(f,a)
{Ext.getCmp('login-popup-statusbar').setStatus({text:a.result.message,iconCls:'',clear:true});},success:function(f,a)
{Ext.getCmp('login-box').destroy();}});}}}}},{xtype:'checkbox',boxLabel:' ',id:'pop-remember',fieldLabel:'Se souvenir de moi',checked:false,name:'remember',listeners:{keyup:function(form,e)
{if(e.getKey()==13)
{var xPopupForm=Ext.getCmp('popupForm').getForm();if(xPopupForm&&xPopupForm.isValid())
{xPopupForm.submit({url:'https://www.grandpariscirculaire.org/index.php/login.html',method:'POST',reset:false,scope:this,failure:function(f,a)
{Ext.getCmp('login-popup-statusbar').setStatus({text:a.result.message,iconCls:'',clear:true});},success:function(f,a)
{Ext.getCmp('login-box').destroy();}});}}}}}],buttons:[{text:'Envoyer',handler:function()
{var xPopupForm=Ext.getCmp('popupForm').getForm();if(xPopupForm&&xPopupForm.isValid())
{xPopupForm.submit({url:'https://www.grandpariscirculaire.org/index.php/login.html',method:'POST',reset:false,scope:this,failure:function(f,a)
{Ext.getCmp('login-popup-statusbar').setStatus({text:a.result.message,iconCls:'',clear:true});},success:function(f,a)
{Ext.getCmp('login-box').destroy();}});}}},{text:'Annuler',handler:function()
{Ext.getCmp('login-box').destroy();}}],bbar:[new Ext.StatusBar({id:'login-popup-statusbar',defaultText:''})]});this.add(this.popupForm);},onRender:function()
{if(getcookie("loginUser"))
Ext.getCmp('pop-login').setValue(getcookie("loginUser"));if(getcookie("remember"))
Ext.getCmp('pop-remember').setValue(true);Ext.ux.LoginBoxPopup.superclass.onRender.apply(this,arguments);this.popupForm.doLayout();this.syncSize();}});Ext.reg('loginboxpopup',Ext.ux.LoginBoxPopup);Ext.ux.TextBox=Ext.extend(Ext.BoxComponent,{constructor:function(cfg){cfg=cfg||{};this.autoEl={tag:'div',html:cfg.text};Ext.ux.TextBox.superclass.constructor.apply(this,arguments);}});Ext.reg('textbox',Ext.ux.TextBox);Ext.namespace("Ext.ux");Ext.ux.ClearCombo=Ext.extend(Ext.form.ComboBox,{trigger1Class:'x-form-clear-trigger',trigger2Class:'x-form-trigger',typeAhead:true,triggerAction:'all',hideTrigger1:true,initComponent:Ext.form.TwinTriggerField.prototype.initComponent,getTrigger:Ext.form.TwinTriggerField.prototype.getTrigger,initTrigger:Ext.form.TwinTriggerField.prototype.initTrigger,onTrigger2Click:Ext.form.ComboBox.prototype.onTriggerClick,reset:Ext.form.Field.prototype.reset.createSequence(function(){this.triggers[0].hide();}),onViewClick:Ext.form.ComboBox.prototype.onViewClick.createSequence(function(){this.triggers[0].show();}),onTrigger1Click:function(){if(this.hiddenField){this.hiddenField.value='';}
this.setRawValue('');this.lastSelectionText='';this.applyEmptyText();this.value='';this.triggers[0].hide();this.fireEvent('clear',this);}});Ext.reg('ClearCombo',Ext.ux.ClearCombo);Ext.ux.SliderTip=Ext.extend(Ext.Tip,{minWidth:10,offsets:[0,-10],init:function(e){e.on("dragstart",this.onSlide,this);e.on("drag",this.onSlide,this);e.on("dragend",this.hide,this);e.on("destroy",this.destroy,this)},onSlide:function(e){this.show();this.body.update(this.getText(e));this.doAutoWidth();this.el.alignTo(e.thumb,"b-t?",this.offsets)},getText:function(e){return e.getValue()}})